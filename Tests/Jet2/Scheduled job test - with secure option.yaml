- defaultTab: nodes
  description: ''
  executionEnabled: true
  group: Tests/Jet2
  id: 3b9e43d4-a6b2-44fe-9f50-ee0c16e6eed9
  loglevel: INFO
  name: Scheduled job test - with secure option
  nodeFilterEditable: false
  nodefilters:
    dispatch:
      excludePrecedence: true
      keepgoing: false
      rankOrder: ascending
      successOnEmptyNodeFilter: false
      threadcount: '1'
    filter: 'name: bdias-eks-runner '
  nodesSelectedByDefault: true
  notification:
    onfailure:
      plugin:
        configuration:
          action: trigger
          component: ${job.execid}
          dedupe_key: ${job.id}
          group: ${job.serverUrl}
          images: https://www.rundeck.com/hubfs/rundeck-app-assets/rundeck-by-pagerduty-icon.png
          pagerdutyUrl: https://events.eu.pagerduty.com
          payload_class: ${job.executionType}
          payload_severity: critical
          payload_source: Runbook Automation
          payload_summary: ${job.status} [${job.project}] "${job.name}" run by ${job.user}
            (#${job.execid}) [ ${job.href} ]
          service_key_storage_path: keys/pagerduty/pdt-bdias-global-orchestration-key
        type: PagerDutyEventNotification
    onsuccess:
      plugin:
        configuration:
          action: resolve
          component: ${job.execid}
          dedupe_key: ${job.id}
          group: ${job.serverUrl}
          images: https://www.rundeck.com/hubfs/rundeck-app-assets/rundeck-by-pagerduty-icon.png
          pagerdutyUrl: https://events.eu.pagerduty.com
          payload_class: ${job.executionType}
          payload_severity: info
          payload_source: Runbook Automation
          payload_summary: ${job.status} [${job.project}] "${job.name}" run by ${job.user}
            (#${job.execid}) [ ${job.href} ]
          service_key_storage_path: keys/pagerduty/pdt-bdias-global-orchestration-key
        type: PagerDutyEventNotification
  notifyAvgDurationThreshold: null
  options:
  - name: aws-api-gateway-key
    secure: true
    storagePath: keys/project/bdias-dev/jet2-tests/aws-api-gateway-key
    valueExposed: true
  plugins:
    ExecutionLifecycle: {}
  scheduleEnabled: true
  schedules: []
  sequence:
    commands:
    - autoSecureInput: 'false'
      passSecureInput: 'false'
      script: |
        #!/bin/bash

        AWS_Key=@option.aws-api-gateway-key@

        echo Running a job with a secure job option...
        echo $AWS_Key
    keepgoing: false
    strategy: node-first
  user: admin
  uuid: 3b9e43d4-a6b2-44fe-9f50-ee0c16e6eed9

